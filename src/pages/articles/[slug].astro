---
import Layout from "../../layouts/Layout.astro";
import { newtClient } from "../../libs/newt";
import type { Article } from "../../libs/newt";
import Container from "../../components/Container.astro";
import Button from "../../components/Button.astro";
import { Image } from "astro:assets";
export const getStaticPaths = async () => {
  const { items: articles } = await newtClient.getContents<Article>({
    appUid: "blog",
    modelUid: "article",
    query: {
      select: ["_id", "title", "slug", "body", "coverImage"],
    },
  });
  return articles.map((article) => ({
    params: { slug: article.slug },
    props: { article },
  }));
};

const { article } = Astro.props;
---

<Layout>
  <Container value="small">
    <div class="blog-single">
      <h1>{article.title}</h1>
      <figure transition:name={article.slug} class="cover">
        <Image
          src={article.coverImage.src}
          width={780}
          height={520}
          alt={article.title}
          loading="eager"
        />
      </figure>
      <article set:html={article.body} />
      <Button text="トップへ" link="/" />
    </div>
  </Container>
</Layout>

<style lang="scss">
  h1 {
    font-size: 3.8rem;
    margin-bottom: 60px;
  }
  .cover {
    width: 100%;
    margin-inline: auto;
    margin-bottom: 60px;
    max-width: 780px;
    img {
      display: block;
      width: 100%;
    }
  }
  .blog-single {
    :global(p) {
      &:not(:last-child) {
        margin-bottom: 1em;
      }
    }
  }
</style>
